st_transform.sfTrack <- function(x, crs = ""){
  x@line = sf::st_transform(x@line, crs)
  x@geometry = sf::st_transform(x@geometry, crs)
  return(x)
}

setMethod("st_transform", "sfTrack", st_transform.sfTrack)

sft1 <- st_transform(sft1, "+proj=utm")
sft2 <- st_transform(sft2, "+proj=utm")

setGeneric(
  name = "st_distance",
  def = function(sft1, sft2, ...) standardGeneric("st_distance")
)


st_distance.sfTrack <- function(sft1, sft2, which = ""){
  dist <- sf::st_distance(sft1@line, sft2@line, which = which)
  return(dist)
}

setMethod("st_distance", "sfTrack", st_distance.sfTrack)

st_distance(sft1, sft2, "Frechet")

print.sfTrack <- function(sft){
  track = sft
  cat("An object of class sfTrack \n");
  cat(paste0(nrow(as.data.frame(track@geometry)), "points"),"\n");
  cat(paste0("bbox:"),"\n");
  print(sf::st_bbox(track@geometry));
  cat(paste0("Time period: [",min(track@time),", ", max(track@time),"]"))
}
setMethod("show", "sfTrack", print.sfTrack)

print.sfTracks <- function(sft){
  cat("An object of class sfTracks" ,"\n");
  cat(paste0(length(sft@tracks)), "sftracks")
}
setMethod("show", "sfTracks", print.sfTracks)

#Coerce to Track
setAs("sfTrack", "Track",
      function(from){
        geometry <- sf::as_Spatial(from@geometry)
        geometry@proj4string = CRS("+proj=longlat +datum=WGS84")
        stidf <- STIDF(sp::geometry(geometry), from@time, from@data)
        track = Track(stidf)
        return(track)
      })
